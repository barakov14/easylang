<div class="min-h-screen p-2">
  <div *ngIf="(projectInfo$ | async) as project">
    <h1 class="font-bold">#{{ project.id }} {{ project.name }}</h1>
    <p>{{ project.description }}</p>
    @if(project.editors.length > 0) {
      @for(editor of project.editors; track editor) {
        {{ project.editors.length }}
        <p>Editors: {{ editor.name }} {{ editor.surname }}</p>
        @if(project.editors.length > 1) {
          <span>, </span>
        }
      }
    } @else {
      <p>No editors here...</p>
      <task-editor-button [projectId]="projectId"></task-editor-button>
    }
  </div>
  <h1 class="text-2xl font-bold mb-4">Backlog</h1>
  <div>
    <button mat-icon-button>
      <mat-icon>filter_list</mat-icon>
    </button>
    <mat-form-field class="w-1/3">
      <mat-label>Search by id, name or description...</mat-label>
      <input matInput />
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
  </div>
  <div class="overflow-x-auto">
    <table class="w-full border-collapse border border-gray-300">
      <tr class="bg-gray-200 text-gray-700">
        <th class="p-4 text-center" colspan="2">User Story</th>
        <th class="p-4 text-center">Status</th>
        <th class="p-4 text-center">Translators</th>
      </tr>
      <ng-container *ngIf="(tasksList$ | async) as tasksList">
        <ng-container *ngIf="tasksList.length > 0; else noTasks">
          @for(task of tasksList; track task) {
            <tr>
              <td class="p-4 text-center border border-gray-300">{{ task.id }}</td>
              <td
                class="p-4 text-center border border-gray-300 text-blue-800np hover:underline cursor-pointer"
                [routerLink]="[task.id]"
              >
                {{ task.name }}
              </td>
              <td class="p-4 text-center border border-gray-300">
                {{ task.status }}
              </td>
              <td class="p-4 text-center border border-gray-300">
                <ng-container
                  *ngIf="task.responsibles.length > 0; else noResponsibles"
                >
                  <ng-container
                    *ngFor="let responsible of task.responsibles; let last = last"
                  >
                    {{ responsible.name }} {{ responsible.surname }}
                    <ng-container *ngIf="!last">, </ng-container>
                  </ng-container>
                </ng-container>
                <ng-template #noResponsibles>
                  No translators responsibled...
                </ng-template>
              </td>
            </tr>
          }
        </ng-container>
      </ng-container>
    </table>
    <ng-template #noTasks>
      <p>There are no tasks here...</p>
    </ng-template>
  </div>
  <tasks-create-button
    [projectId]="projectId"
    class="fixed bottom-8 right-8"
  ></tasks-create-button>
</div>
